CREATE DEFINER=`CONADIS`@`%` PROCEDURE `seleccionar_datos_per_discapacidad_v1`(in codigo int)
BEGIN
 SELECT  INSCRIPCION_CONADIS_PASCO.ID,INSCRIPCION_CONADIS_PASCO.ID_PER_DISCAPACIDAD, CONCAT_WS( '/',PER_DISCAPACIDAD.DNI,PER_DISCAPACIDAD.CUI) AS DNI_CUI,
CONCAT(PER_DISCAPACIDAD.APELL_PATERNO,' ',PER_DISCAPACIDAD.APELL_MATERNO,', ', PER_DISCAPACIDAD.NOMBRES) AS   APELLIDOS_NOMBRES, 
PER_DISCAPACIDAD.FECHA_NACIMIENTO , IF(PER_DISCAPACIDAD.SEXO=2,'Femenino','Masculino') AS SEXO, 
(SELECT NOMBRE FROM NIVEL_EDUCATIVO WHERE ID=PER_DISCAPACIDAD.ID) AS NIVEL_EDUCATIVO,
(SELECT NOMBRE FROM TIPO_TRABAJO WHERE ID=PER_DISCAPACIDAD.ID_TIPO_TRABAJO) AS TIPO_TRABAJO,
(SELECT NOMBRE FROM ESTADO_CIVIL WHERE ID=PER_DISCAPACIDAD.ID_ESTADO_CIVIL) AS ESTADO_CIVIL,

(SELECT GROUP_CONCAT((SELECT NOMBRE FROM PROGRAMA_SOCIAL WHERE ID=d_programa_social_per_discapacidad.ID_PROGRAMA_SOCIAL))  FROM d_programa_social_per_discapacidad WHERE d_programa_social_per_discapacidad.ID_PER_DISCAPACIDAD=PER_DISCAPACIDAD.ID ) AS GROUP_PROGRAMA_SOCIAL,
NRO_CARNE,
ANNO_INCRIPCCION,
(SELECT FECHA_CERTIFICADO FROM certificado_medico WHERE ID= INSCRIPCION_CONADIS_PASCO.ID) AS FECHA_CERTIFICADO_MEDICO_EMISION,

(SELECT  NUMERO_CERTIFICADO FROM certificado_medico WHERE ID=INSCRIPCION_CONADIS_PASCO.ID) AS NUMERO_CERTIFICADO,

(SELECT DIAGNOSTICO_MEDICO FROM certificado_medico WHERE ID= INSCRIPCION_CONADIS_PASCO.ID) AS DIAGNOSTICO_MEDICO,

(SELECT NRO_RESOLUCION FROM resolucion WHERE ID=INSCRIPCION_CONADIS_PASCO.ID) AS NRO_RESOLUCION,
(SELECT FECHA FROM resolucion WHERE ID=INSCRIPCION_CONADIS_PASCO.ID) AS FECHA_RESOLUCION,

(SELECT PROVINCIA.NOMBRE FROM PROVINCIA WHERE ID=(SELECT DISTRITO.ID_PROVINCIA FROM DISTRITO WHERE 
ID=(SELECT DOMICILIO.ID_DISTRITO FROM DOMICILIO WHERE ID=PER_DISCAPACIDAD.ID_DOMICILIO))) AS PROVINCIA,
(SELECT DISTRITO.NOMBRE FROM DISTRITO WHERE ID=(SELECT DOMICILIO.ID_DISTRITO FROM DOMICILIO WHERE ID=PER_DISCAPACIDAD.ID_DOMICILIO)) AS DISTRITO,
(SELECT DOMICILIO.NOMBRE_VIA FROM DOMICILIO WHERE ID=PER_DISCAPACIDAD.ID_DOMICILIO) AS NOMBRE_VIA_DOMICILIO ,
(SELECT TIENE_CERTIFICADO_DISCAPACIDAD.NOMBRE FROM TIENE_CERTIFICADO_DISCAPACIDAD WHERE ID=INSCRIPCION_CONADIS_PASCO.ID_TIENE_CERTIFICADO_DISCAPACIDAD) AS TIENE_CERTIFICADO_DISCAPACIDAD,
(SELECT TIENE_INSCRIPCION_CONADIS.NOMBRE FROM TIENE_INSCRIPCION_CONADIS WHERE ID=INSCRIPCION_CONADIS_PASCO.ID_TIENE_INSCRIPCION_CONADIS) AS TIENE_INSCRIPCION_CONADIS,
(SELECT GROUP_CONCAT((SELECT TIPO_DISCAPACIDAD.NOMBRE FROM TIPO_DISCAPACIDAD WHERE ID=D_TIPO_DISCAPACIDAD_CERTIFICADO_MEDICO.ID_TIPO_DISCAPACIDAD))  FROM D_TIPO_DISCAPACIDAD_CERTIFICADO_MEDICO WHERE ID_CERTIFICADO_MEDICO=INSCRIPCION_CONADIS_PASCO.ID) AS GROUP_TIPO_DISCAPACIDAD,
(SELECT NIVEL_GRAVEDAD_LIMITACION.NOMBRE FROM NIVEL_GRAVEDAD_LIMITACION WHERE ID=(SELECT CERTIFICADO_MEDICO.ID_NIVEL_GRAVEDAD_LIMITACION FROM CERTIFICADO_MEDICO WHERE CERTIFICADO_MEDICO.ID=INSCRIPCION_CONADIS_PASCO.ID)) AS NIVEL_GRAVEDAD

FROM INSCRIPCION_CONADIS_PASCO INNER JOIN PER_DISCAPACIDAD ON INSCRIPCION_CONADIS_PASCO.ID_PER_DISCAPACIDAD=PER_DISCAPACIDAD.ID WHERE inscripcion_conadis_pasco.ID=codigo ;


END